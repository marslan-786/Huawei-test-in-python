[supervisord]
nodaemon=true

# 1. Screen (Display :0)
[program:xvfb]
command=/usr/bin/Xvfb :0 -screen 0 1280x720x24
autorestart=true
priority=10

# 2. Desktop UI (Wait for Xvfb)
[program:fluxbox]
command=/usr/bin/fluxbox
autorestart=true
priority=20
environment=DISPLAY=":0"

# 3. VNC Server (Removed -bg flag)
# -bg flag was causing the exit 0 error
[program:x11vnc]
command=/usr/bin/x11vnc -display :0 -forever -shared -nopw
autorestart=true
priority=30

# 4. Web Viewer (Direct Websockify)
# launch.sh was missing (Error 127), so we use raw python command
[program:novnc]
command=/usr/bin/websockify --web /usr/share/novnc 0.0.0.0:%(ENV_PORT)s localhost:5900
autorestart=true
priority=40